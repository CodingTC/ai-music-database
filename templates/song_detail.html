{% extends "layout.html" %}
{% block content %}
<h1>{{ song.title }}</h1>

<div style="display: flex; flex-wrap: wrap;">
    <div style="flex: 2; margin-right: 20px;">
        <div class="section">
            <h2 class="section-header">Song Details</h2>
            <p><strong>Artist:</strong> {{ song.artist }}</p>
            <p><strong>Cluster ID:</strong> {{ song.cluster_id }}</p>
            
            <h3>Audio Features</h3>
            <div style="display: flex;">
                <div style="flex: 1;">
                    <p><strong>Tempo:</strong> {{ song.tempo }}</p>
                    <p><strong>Energy:</strong> {{ song.energy }}</p>
                </div>
                <div style="flex: 1;">
                    <p><strong>Danceability:</strong> {{ song.danceability }}</p>
                    <p><strong>Loudness:</strong> {{ song.loudness }}</p>
                </div>
            </div>
            
            <div>
                <button onclick="showModal('addToPlaylistModal')">Add to Playlist</button>
            </div>
        </div>
    </div>
    
    <div style="flex: 1;">
        <div class="section">
            <h2 class="section-header">Similar Songs (Same Cluster)</h2>
            <ul>
                {% for similar in similar_songs %}
                <li>
                    <a href="{{ url_for('song_detail', song_id=similar.song_id) }}">
                        {{ similar.title }} - {{ similar.artist }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>

<!-- Add to Playlist Modal -->
<div id="addToPlaylistModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.4); z-index: 1000;">
  <div style="background-color: white; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 50%;">
    <span onclick="hideModal('addToPlaylistModal')" style="float: right; cursor: pointer;">&times;</span>
    <h2>Add to Playlist</h2>
    <form method="POST" action="{{ url_for('add_to_playlist') }}">
      <input type="hidden" name="song_id" value="{{ song.song_id }}">
      <div>
        <label for="playlist_id">Select Playlist</label>
        <select id="playlist_id" name="playlist_id" required>
          {% for playlist in playlists %}
          <option value="{{ playlist.playlist_id }}">{{ playlist.name }}</option>
          {% endfor %}
        </select>
      </div>
      <button type="submit" class="button primary">Add to Playlist</button>
    </form>
  </div>
</div>
{% endblock %}